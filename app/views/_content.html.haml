.container
  %article
    %hr
    %section#getting_started
      .holder
      .frame
        %h2 Getting Started

        %p The HTML page includes 3 key libraries:

        %ul
          %li The core PubNub JS Library (generally from the CDN)
          %li AngularJS (usually as a Bower component)
          %li PubNub Angular (copy & paste for now - bower component coming soon!)

        %p The HTML code looks like this:

        %pre.well
          :escaped
            <script src="http://cdn.pubnub.com/pubnub-3.5.3.js"></script>
            <script src="components/angular/angular.js"></script>
            <script src="scripts/pubnub-angular.js"></script>

        %p The app is Angular-enabled with an <code>ng-app</code> attribute:

        %pre.well
          :escaped
            <body ng-app="PubNubAngularApp">

        %p Where 'PubNubAngularApp' is the name of the Angular module containing our app.

        %p The code for the app lives in:

        %pre.well
          :escaped
            <script src="scripts/app.js"></script>

    %hr
    %section#angular_api
      .holder
      .frame
        %h2 The PubNub Angular API
        
        %p The PubNub Angular API lives in the <code>scripts/pubnub-angular.js</code> file.

        %p Notice the dependency on the PubNub Angular library (<code>pubnub.angular.service</code>):

        %pre.well
          :escaped
            angular.module('PubNubAngularApp', ["pubnub.angular.service"])

        %p The code for the controllers lives in:

        %pre.well
          :escaped
            <script src="scripts/controllers/main.js"></script>

        %p Now, the <code>PubNub</code> service can be injected into the controller by name!

        %pre.well
          :escaped
            .controller('JoinCtrl', function($scope, PubNub) { ... });

        %h4 Using the Special AngularJS PubNub API

        %p Publishing to channels is trivial - just use the <code>PubNub.ngPublish()</code> method.

        %pre.well
          :escaped
            $scope.publish = function() {
              PubNub.ngPublish({
                channel: $scope.selectedChannel,
                message: $scope.newMessage
              });
            };

        %p
          As you can see, we call the PubNub publish method passing in the desired
          channel and message to transmit. It is also possible to transmit structured
          data as JSON objects, so go wild!
          
        %p
          It's not necessary to subscribe to a channel in order to publish to a channel.

        %p
          Subscribing to channels is accomplished by calling the <code>PubNub.ngSubscribe()</code>
          method. After the channel is subscribed, the app can register root scope message events
          by calling <code>$rootScope.$on</code> with the event string returned by
          <code>PubNub.ngMsgEv(channel)</code>.

        %pre.well
          :escaped
            $scope.subscribe = function() {
              ...
              PubNub.ngSubscribe({ channel: theChannel })
              ...
              $rootScope.$on(PubNub.ngMsgEv(theChannel), function(event, payload) {
                // payload contains message, channel, env...
                console.log('got a message event:', payload);    
              })

        %p
          This is the core of the PubNub API - allowing clients to subscribe and
          publish to channels, and have those events propagate in real-time to other
          applications connected to the same channels.


        %h4 Integrating Presence Events

        %p
          It's also easy to integrate presence events using the Angular API. In
          the example above, we just add an additional couple lines of code to
          call the <code>PubNub.ngHereNow()</code> method (retrieve current users), and register
          for presence events by calling <code>$rootScope.$on</code> with the event string
          returned by <code>PubNub.ngPrsEv(channel)</code>.

        %pre.well
          :escaped
            $scope.subscribe = function() {
              ...
              PubNub.ngSubscribe({ channel: theChannel })
              $rootScope.$on(PubNub.ngMsgEv(theChannel), function(event, payload) { ... })
              ...
              $rootScope.$on(PubNub.ngPrsEv(theChannel), function(event, payload) {
                // payload contains message, channel, env...
                console.log('got a presence event:', payload);
              })

              PubNub.ngHereNow { channel: theChannel }

        %p
          Using the presence event as a trigger, we retrieve the Presence
          list for a channel using the <code>PubNub.ngListPresence()</code>
          function.

        %pre.well
          :escaped
            $rootScope.$on(PubNub.ngPrsEv(theChannel), function(event, payload) {
              $scope.users = PubNub.ngListPresence(theChannel);
            })


        %h4 Retrieving History

        %p
          It can be super-handy to gather the previous several hundred messages
          from the PubNub channel history. The PubNub Angular API makes this easy
          by bridging the event model of the PubNub JS history API and the AngularJS
          event broadcast model so that historical messages come through the same
          event interface.

        %pre.well
          :escaped
            PubNub.ngHistory({channel:theChannel, count:500});
            // messages will be broadcast via $rootScope...


        %h4 Listing & Unsubscribing from Channels

        %p
          The PubNub Angular API takes care of keeping track of currently subscribed
          channels. Call the <code>PubNub.ngListChannels()</code> method to return a
          list of presently subscribed channels.

        %pre.well
          :escaped
            $scope.channels = PubNub.ngListChannels()

        %p
          Unsubscribing is as easy as calling the <code>PubNub.ngUnsubscribe()</code>
          method. The library even takes care of removing the Angular event handlers
          for you to prevent unsightly memory leaks!

        %pre.well
          :escaped
            PubNub.ngUnsubscribe({channel:theChannel})


        %h4 Using the PubNub API directly

        %p
          We know that newer and fancier isn't always better. That's why we prefixed
          all of the special AngularJS methods with "ng". If you need to call the more
          common PubNub JS API methods, they're most likely already available from the
          PubNub member of the same name!

        %p For example:
       
        %ul
          %li <code>PubNub.publish</code>
          %li <code>PubNub.subscribe</code>
          %li <code>PubNub.unsubscribe</code>
          %li <code>PubNub.here_now</code>
          %li <code>PubNub.history</code>

        %p
          %span.label.label-warning DANGER
          These methods do not call the internal bookkeeping methods
          to make sure the channel lists and rootScope broadcast events
          get propagated, so use with care!

        %p
          For the most advanced PubNub API methods, you can call them by accessing
          <code>PubNub['_instance']</code>.

        %p
          Stay tuned though! We'll be adding support for more PubNub APIs soon.


/    %section#annotated_source
/      .holder
/      .frame
/        %h2 Annotated Example Source
/        %pre#source.well(ng-include=true src="'scripts/controllers/main.js'")
